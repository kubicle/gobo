!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.g)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.gobo=t()}}(function(){return function t(i,e,h){function s(o,r){if(!e[o]){if(!i[o]){var n="function"==typeof require&&require;if(!r&&n)return n(o,!0);if(a)return a(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var c=e[o]={exports:{}};i[o][0].call(c.exports,function(t){var e=i[o][1][t];return s(e||t)},c,c.exports,t,i,e,h)}return e[o].exports}for(var a="function"==typeof require&&require,o=0;o<h.length;o++)s(h[o]);return s}({1:[function(t,i,e){"use strict";e.h=!0;var h=t("./wood.js"),s=t("./cheapSeed"),a={9:[[5,5]],13:[[4,4],[10,4],[4,10],[10,10]],19:[[4,4],[10,4],[16,4],[4,10],[10,10],[16,10],[4,16],[10,16],[16,16]]},o=5,r=/[.,:;|`'!]/g,n=[[.1,.09,.08,.07,.06,.06,.06,.06,.06,.06,.06],[.1,.12,.11,.1,.09,.09,.09,.09],[.12,.14,.13,.12,.12,.12]],f=function(){function t(t){this.pixelRatio=Math.max(1,t.pixelRatio||1),this.width=t.widthPx*this.pixelRatio,this.height=(t.heightPx||t.widthPx)*this.pixelRatio,t.widthPx||(console.error("Invalid gobo widthPx: "+t.widthPx),this.width=this.height=100),this.isSketch=!!t.isSketch,this.i=!t.noCoords,this.j=(t.marginPx||o)*this.pixelRatio,this.backgroundCanvas=t.backgroundCanvas,this.background=t.background,this.patternSeed=t.patternSeed||Math.random()}return t.prototype.k=function(t){return this.l=t,this.m(),this.isSketch||this.o(),this.p(),this.q(),this.canvas},t.prototype.render=function(){this.s(),this.t(),this.u(),this.i&&this.v(),this.A()},t.prototype.B=function(){return this.canvas},t.prototype.p=function(){this.canvas=this.C(this.width,this.height),this.D.textAlign="center",this.D.textBaseline="middle"},t.prototype.C=function(t,i){var e=document.createElement("canvas");return e.width=t,e.height=i,this.D=e.getContext("2d"),e},t.prototype.m=function(){var t=Math.min(this.width,this.height);this.gobanSize=this.l.gobanSize,this.i?(this.F=(t-2*this.j)/(this.gobanSize+2),this.F>10*this.pixelRatio?(this.G=10*this.pixelRatio,this.F=(t-2*this.j-2*this.G)/this.gobanSize):this.G=this.F,this.H=this.j+this.G):(this.F=(t-2*this.j)/this.gobanSize,this.H=this.j),this.I=this.F/2,this.J=.55*this.F,this.fontSize=.8*this.F,this.K=Math.round(this.H+this.F/2+(this.width-t)/2),this.L=Math.round(this.H+this.F/2+(this.height-t)/2),this.M=this.L+(this.gobanSize-1)*this.F,this.N=this.K+(this.gobanSize-1)*this.F},t.prototype.pixelToGridCoordinates=function(t,i){return[Math.round((t-this.K)/this.F),Math.round((this.M-i)/this.F)]},t.prototype.q=function(){if(!this.backgroundCanvas)if(this.background){if("#"===this.background[0]||"rgb"===this.background.substr(0,3).toLowerCase())this.backgroundColor=this.background;else if("wood"===this.background){if(this.isSketch||this.backgroundCanvas)return;var t=this.backgroundCanvas=document.createElement("canvas");t.width=t.height=200*this.pixelRatio,h.O(t,this.patternSeed,this.patternSeed)}}else this.backgroundColor="#c75"},t.prototype.o=function(){s.P(this.patternSeed);var t=this.F,i=t/2;this.R=this.C(t,t),this.S(i,i),this.T=[];for(var e=10;e>=0;e--)this.T.push(this.C(t,t)),this.U(i,i,this.I);this.V=[];for(var e=17;e>=0;e--)this.V.push(this.C(t,t)),this.W(i,i,this.I);this.X=[];for(var h=0;h<this.gobanSize;h++)for(var a=this.X[h]=[],e=0;e<this.gobanSize;e++)a.push(~~(11*s.Y()));this.Z=[];for(var h=0;h<this.gobanSize;h++)for(var a=this.Z[h]=[],e=0;e<this.gobanSize;e++){var o=e%3+h%3*3,r=e%6<3==h%6<3?0:1,n=o+9*r;a.push(n)}this.$=this.C(t,t),this.W(i,i,this.I/2),this._=this.C(t,t),this.U(i,i,this.I/2)},t.prototype.aa=function(){this.backgroundCanvas?this.D.fillStyle=this.D.createPattern(this.backgroundCanvas,"repeat"):this.D.fillStyle=this.backgroundColor},t.prototype.s=function(){this.aa(),this.D.fillRect(0,0,this.width,this.height)},t.prototype.t=function(){this.D.strokeStyle="#000",this.D.lineWidth=1,this.D.beginPath();for(var t=0;t<this.gobanSize;t++){var i=this.K+t*this.F;this.D.moveTo(i,this.L),this.D.lineTo(i,this.M);var e=this.L+t*this.F;this.D.moveTo(this.K,e),this.D.lineTo(this.N,e)}this.D.stroke()},t.prototype.u=function(){this.D.fillStyle="#000";var t=a[this.gobanSize];if(t)for(var i=0;i<t.length;i++){var e=t[i],h=(e[0]-1)*this.F+this.K,s=(e[1]-1)*this.F+this.L;this.D.beginPath(),this.D.arc(h,s,this.F/9,0,2*Math.PI),this.D.fill()}},t.prototype.v=function(){this.D.fillStyle="#000",this.D.font=this.G+"px Arial";for(var t="ABCDEFGHJKLMNOPQRSTUVWXYZ",i=this.I+this.H/2,e=this.K,h=this.L-i,s=this.M+i,a=0;a<this.gobanSize;a++)this.D.fillText(t[a],e,h),this.D.fillText(t[a],e,s),e+=this.F;for(var o=this.K-i,r=this.N+i,n=this.L,a=0;a<this.gobanSize;a++){var f=(this.gobanSize-a).toString();this.D.fillText(f,o,n),this.D.fillText(f,r,n),n+=this.F}},t.prototype.A=function(){for(var t=this.isSketch?1:2,i=0;i<t;i++)for(var e=0;e<this.gobanSize;e++)for(var h=0;h<this.gobanSize;h++)this.ba(h,e,i)},t.prototype.ba=function(t,i,e){var h=t*this.F+this.K,s=this.M-i*this.F,a=this.l.ca(t,i);-1!==a.da&&(0!==e||this.isSketch?this.fa(h,s,a.da,t,i):this.ea(h,s)),(-1===a.da||1===e||this.isSketch)&&(a.mark&&this.ga(h,s,a),a.label&&this.ha(h,s,a,a.label))},t.prototype.ea=function(t,i){var e=.25*this.I,h=this.I-e;this.D.drawImage(this.R,t-h,i-h)},t.prototype.fa=function(t,i,e,h,s){if(this.isSketch)return this.ia(t,i,e,this.I);var a;a=0===e?this.T[this.X[s][h]]:this.V[this.Z[s][h]],this.D.drawImage(a,t-this.I,i-this.I)},t.prototype.ia=function(t,i,e,h){this.D.fillStyle=0===e?"rgb(0,0,0)":"rgb(255,255,255)",this.D.beginPath(),this.D.arc(t,i,.93*h,0,2*Math.PI),this.D.fill()},t.prototype.ja=function(t,i,e,h){if(this.isSketch||-1!==h){var s=.4*this.I;return this.ia(t,i,e,s)}var s=this.I,a=0===e?this._:this.$;this.D.drawImage(a,t-s,i-s,2*s,2*s)},t.prototype.S=function(t,i){var e=.1*this.I,h=.95*this.I,s=this.D.createRadialGradient(t,i,h-1-e,t,i,h+e);s.addColorStop(0,"rgba(32,32,32,0.5)"),s.addColorStop(1,"rgba(62,62,62,0)"),this.D.fillStyle=s,this.D.beginPath(),this.D.arc(t,i,h+e,0,2*Math.PI,!0),this.D.fill()},t.prototype.ka=function(t,i,e,h,s,a,o){var r=e/5,n=this.D.createRadialGradient(t-2*r,i-2*r,a*e,t-r,i-r,o*e);n.addColorStop(0,h),n.addColorStop(1,s),this.D.beginPath(),this.D.fillStyle=n,this.D.arc(t,i,.95*e,0,2*Math.PI,!0),this.D.fill()},t.prototype.U=function(t,i,e){var h=.8-.2*s.Y(),a=40*s.Y()+76,o="rgb("+~~(10*s.Y()+a)+","+~~(10*s.Y()+a)+","+~~(10*s.Y()+a)+")";this.ka(t,i,e,o,"#000",.01,h)},t.prototype.W=function(t,i,e){this.ka(t,i,e,"#fff","#aaa",.33,1);var h=n[~~(3*s.Y())],a=2*s.Y()*Math.PI,o=1+1.5*s.Y(),r=.2+.3*s.Y();this.la(t,i,e,a,h,r,o)},t.prototype.la=function(t,i,e,h,a,o,r){for(var n=h,f=h,c=0;c<a.length;c++){n+=a[c],f-=a[c];var l=.15*s.Y()+0;this.ma(t,i,e,n,f,o,r,l)}},t.prototype.ma=function(t,i,e,h,s,a,o,r){var n=this.D;r=~~(100*r)/100,n.strokeStyle="rgba(128,128,128,"+r+")",n.lineWidth=e/30*o,n.beginPath(),e-=Math.max(1,n.lineWidth);var f,c,l,u,p=t+e*Math.cos(h*Math.PI),d=i+e*Math.sin(h*Math.PI),v=t+e*Math.cos(s*Math.PI),g=i+e*Math.sin(s*Math.PI);v>p?(f=(g-d)/(v-p),c=Math.atan(f)):v===p?c=Math.PI/2:(f=(g-d)/(v-p),c=Math.atan(f)-Math.PI);var y=a*e;l=Math.sin(c)*y,u=Math.cos(c)*y;var b=p+l,S=d-u,k=v+l,D=g-u;n.moveTo(p,d),n.bezierCurveTo(b,S,k,D,v,g),n.stroke()},t.prototype.na=function(t,i,e){switch(e.da){case-1:if("+"!==e.mark[0]){this.aa();var h=.8*this.F;this.D.fillRect(t-h/2,i-h/2,h,h)}return"#000";case 0:return"#fff";case 1:return"#000"}},t.prototype.ga=function(t,i,e){var h=this.D,s=e.mark.split(":"),a=s[0],o=s.length>1?s[1].split(","):[],r=(parseInt(o[0])/10||1)*this.J,n=r/2,f=(parseInt(o[1])||5)*r/24;switch(a){case"[]":h.strokeStyle=this.na(t,i,e),h.lineWidth=f,h.strokeRect(t-n,i-n,r,r);break;case"O":h.strokeStyle=this.na(t,i,e),h.lineWidth=f,h.beginPath(),h.arc(t,i,n,0,2*Math.PI),h.stroke();break;case"*":h.fillStyle=this.na(t,i,e),h.font=1.5*this.fontSize+"px Arial",h.fillText("*",t,i+.35*this.fontSize);break;case"+":h.strokeStyle=this.na(t,i,e),h.lineWidth=f,h.beginPath(),h.moveTo(t-n,i),h.lineTo(t+n,i),h.moveTo(t,i-n),h.lineTo(t,i+n),h.stroke();break;case"+?":h.fillStyle="#888",h.fillRect(t-n,i-n,r,r);break;case"+Bo":case"+Wo":this.ja(t,i,"B"===a[1]?0:1,e.da);break;default:console.error("Unknown mark type: "+e.mark)}},t.prototype.ha=function(t,i,e,h){this.D.fillStyle=this.na(t,i,e),e.style&&(this.D.fillStyle=e.style);var s=h.replace(r,"").length,a=h.length-s,o=s+.5*a,n=1.2-.2*o,f=Math.max(this.fontSize*n,12*this.pixelRatio);this.D.font=f+"px Arial",this.D.fillText(h,t,i)},t}();e.oa=f},{"./cheapSeed":5,"./wood.js":6}],2:[function(t,i,e){"use strict";e.h=!0;var h=t("./LogicalBoard"),s=t("./BoardRenderer"),a=function(){function t(t){this.pa=new h.qa(t.gobanSize||19),this.ra=new s.oa(t),this.canvas=this.ra.k(this.pa)}return t.prototype.render=function(){this.ra.render()},t.prototype.setStoneAt=function(t,i,e){this.pa.setStoneAt(t,i,e)},t.prototype.clearVertexAt=function(t,i){this.pa.clearVertexAt(t,i)},t.prototype.getStoneColorAt=function(t,i){return this.pa.ca(t,i).da},t.prototype.setLabelAt=function(t,i,e,h){this.pa.setLabelAt(t,i,e,h)},t.prototype.setMarkAt=function(t,i,e){this.pa.setMarkAt(t,i,e)},t.prototype.pixelToGridCoordinates=function(t,i){return this.ra.pixelToGridCoordinates(t,i)},t}();e.Gobo=a},{"./BoardRenderer":1,"./LogicalBoard":3}],3:[function(t,i,e){"use strict";e.h=!0;var h=t("./Vertex"),s=function(){function t(t){this.gobanSize=t,this.sa=new Array(t);for(var i=0;i<t;i++){this.sa[i]=new Array(t);for(var e=0;e<t;e++)this.sa[i][e]=new h.ta}}return t.prototype.ca=function(t,i){var e=this.sa[i][t];if(!e)throw new Error("Invalid coordinates: "+t+","+i);return e},t.prototype.clearVertexAt=function(t,i){this.ca(t,i).clear()},t.prototype.setStoneAt=function(t,i,e){this.ca(t,i).ua(e)},t.prototype.setLabelAt=function(t,i,e,h){var s=this.ca(t,i);s.va(e),h&&s.wa(h)},t.prototype.setMarkAt=function(t,i,e){this.ca(t,i).xa(e)},t}();e.qa=s},{"./Vertex":4}],4:[function(t,i,e){"use strict";e.h=!0;var h=function(){function t(){this.clear()}return t.prototype.clear=function(){this.da=-1,this.label="",this.mark=""},t.prototype.ua=function(t){this.da=t},t.prototype.va=function(t){this.label=t},t.prototype.xa=function(t){this.mark=t},t.prototype.wa=function(t){this.style=t},t}();e.ta=h},{}],5:[function(t,i,e){"use strict";var h;e.P=function(t){if(!(t>=0&&t<=1))throw new Error("Seed must be between 0 and 1");h=t},e.Y=function(){var t=43046721*h+.236067977;return h=t-Math.floor(t)},e.ya=function(t,i){return e.Y()*(i-t)+t}},{}],6:[function(t,i,e){function h(){var t=[];t[v]=1;var i=t[g]=d(x[0],x[1]);return t[y]=d(i*M[0],i*M[1]),t}function s(t){for(var i=[0,0,0],e=d(w[0],w[1]),h=0;h<3;h++)i[h]=t[h]*e;return i}function a(t,i){for(var e=~~(t/f),h=t,s=[],a=e;a>=2;a--){var o=(p()+.5)*(h/a);s.push(o),h-=o,i.push(0)}return s.push(h),s}function o(t,i,e,h,s,a){for(var o=h,r=i.length,n=Math.max((a-s)/D+1,0),l=0;l<r-1;l++){var u=(l+.5)*f,d=h-o+i[l]/2,v=Math.max((d-h)/k+1,0),g=Math.min(Math.abs(d-u)/c,1),y=e[l];y=y*(1-g)+(p()-.5)*S,e[l]=y=Math.max(Math.min(y,b),-b);var x=i[l]+y;x=o/(r-l)*v+x*(1-v);var M=t[l]*n+x*(1-n);i[l]=M,o-=M}i[r-1]=o}function r(t){for(var i=h(),e=s(i),a=d(m[0],m[1]),o=[0,0,0],r=[],n=t-1;n>=0;n--){for(var f=n%2?1-p()*a:0+p()*a,c=0;c<3;c++)o[c]=f*i[c]+(1-f)*e[c];for(var l="#",c=0;c<3;c++)l+=("0"+Math.round(255*o[c]).toString(16)).slice(-2);r[n]=l}return r}function n(t,i,e){u(e),f=d(1.2,2.4),c=d(1,2.5)*f;var h=[],s=a(t.width,h),n=s.length;u(i);var l=r(n);u(e);for(var p=s.concat(),v=t.getContext("2d"),g=0;g<t.height;g++){for(var y=0,b=0;b<n;b++){v.fillStyle=l[b];var S=p[b];v.fillRect(y,g,S+1,1),y+=S}o(s,p,h,t.width,t.height,g)}}var f,c,l=t("./cheapSeed"),u=l.P,p=l.Y,d=l.ya,v=0,g=1,y=2,b=.12,S=b/8,k=30,D=100,x=[.4,.85],M=[.6,.9],w=[.75,.9],m=[.2,.5];e.O=function(t,i,e){n(t,i,e)}},{"./cheapSeed":5}]},{},[2])(2)});