!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.g)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.h=t()}}(function(){return function t(i,h,s){function a(r,e){if(!h[r]){if(!i[r]){var n="function"==typeof require&&require;if(!e&&n)return n(r,!0);if(o)return o(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var f=h[r]={exports:{}};i[r][0].call(f.exports,function(t){var h=i[r][1][t];return a(h||t)},f,f.exports,t,i,h,s)}return h[r].exports}for(var o="function"==typeof require&&require,r=0;r<s.length;r++)a(s[r]);return a}({1:[function(t,i,h){"use strict";h.i=!0;var s=t("./wood.js"),a={9:[[5,5]],13:[[4,4],[10,4],[4,10],[10,10]],19:[[4,4],[10,4],[16,4],[4,10],[10,10],[16,10],[4,16],[10,16],[16,16]]},o=5,r=/[.,:;|`'!]/g,e=[[.1,.09,.08,.07,.06,.06,.06,.06,.06,.06,.06],[.1,.12,.11,.1,.09,.09,.09,.09],[.12,.14,.13,.12,.12,.12]],n=function(){function t(t){this.width=t.widthPx,this.height=t.heightPx||t.widthPx,t.widthPx||(console.error("Invalid gobo widthPx: "+t.widthPx),this.width=this.height=100),this.isSketch=!!t.isSketch,this.j=!t.noCoords,this.k=t.marginPx||o,this.backgroundCanvas=t.backgroundCanvas,this.background=t.background}return t.prototype.l=function(t){return this.m=t,this.o(),this.isSketch||this.p(),this.q(),this.s(),this.canvas},t.prototype.render=function(){this.t(),this.u(),this.v(),this.j&&this.A(),this.B()},t.prototype.C=function(){return this.canvas},t.prototype.q=function(){this.D(this.width,this.height),this.F.textAlign="center",this.F.textBaseline="middle"},t.prototype.D=function(t,i){return this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=i,this.F=this.canvas.getContext("2d"),this.canvas},t.prototype.o=function(){var t=Math.min(this.width,this.height);this.gobanSize=this.m.gobanSize,this.j?(this.G=(t-2*this.k)/(this.gobanSize+2),this.G>10?(this.H=10,this.G=(t-2*this.k-2*this.H)/this.gobanSize):this.H=this.G,this.I=this.k+this.H):(this.G=(t-2*this.k)/this.gobanSize,this.I=this.k),this.J=this.G/2,this.K=.55*this.G,this.fontSize=.8*this.G,this.L=Math.round(this.I+this.G/2+(this.width-t)/2),this.M=Math.round(this.I+this.G/2+(this.height-t)/2),this.N=this.M+(this.gobanSize-1)*this.G,this.O=this.L+(this.gobanSize-1)*this.G},t.prototype.pixelToGridCoordinates=function(t,i){return[Math.round((t-this.L)/this.G),Math.round((this.N-i)/this.G)]},t.prototype.s=function(){if(!this.backgroundCanvas)if(this.background){if("#"===this.background[0]||"rgb"===this.background.substr(0,3).toLowerCase())this.backgroundColor=this.background;else if("wood"===this.background){if(this.isSketch||this.backgroundCanvas)return;var t=this.backgroundCanvas=document.createElement("canvas");t.width=200,t.height=200,s.P(t,Math.random())}}else this.backgroundColor="#c75"},t.prototype.p=function(){var t=this.G,i=t/2;this.R=this.D(t,t),this.S(i,i),this.T=[];for(var h=10;h>=0;h--)this.T.push(this.D(t,t)),this.U(i,i,this.J);this.V=[];for(var h=17;h>=0;h--)this.V.push(this.D(t,t)),this.W(i,i,this.J);this.X=[];for(var s=0;s<this.gobanSize;s++)for(var a=this.X[s]=[],h=0;h<this.gobanSize;h++)a.push(~~(11*Math.random()));this.Y=[];for(var s=0;s<this.gobanSize;s++)for(var a=this.Y[s]=[],h=0;h<this.gobanSize;h++){var o=h%3+s%3*3,r=h%6<3==s%6<3?0:1,e=o+9*r;a.push(e)}this.Z=this.D(t,t),this.W(i,i,this.J/2),this.$=this.D(t,t),this.U(i,i,this.J/2)},t.prototype._=function(){this.backgroundCanvas?this.F.fillStyle=this.F.createPattern(this.backgroundCanvas,"repeat"):this.F.fillStyle=this.backgroundColor},t.prototype.t=function(){this._(),this.F.fillRect(0,0,this.width,this.height)},t.prototype.u=function(){this.F.strokeStyle="#000",this.F.beginPath();for(var t=0;t<this.gobanSize;t++){var i=this.L+t*this.G;this.F.moveTo(i,this.M),this.F.lineTo(i,this.N);var h=this.M+t*this.G;this.F.moveTo(this.L,h),this.F.lineTo(this.O,h)}this.F.stroke()},t.prototype.v=function(){this.F.fillStyle="#000";var t=a[this.gobanSize];if(t)for(var i=0;i<t.length;i++){var h=t[i],s=(h[0]-1)*this.G+this.L,o=(h[1]-1)*this.G+this.M;this.F.beginPath(),this.F.arc(s,o,this.G/9,0,2*Math.PI),this.F.fill()}},t.prototype.A=function(){this.F.font=this.H+"px Arial";for(var t="ABCDEFGHJKLMNOPQRSTUVWXYZ",i=this.J+this.I/2,h=this.L,s=this.M-i,a=this.N+i,o=0;o<this.gobanSize;o++)this.F.fillText(t[o],h,s),this.F.fillText(t[o],h,a),h+=this.G;for(var r=this.L-i,e=this.O+i,n=this.M,o=0;o<this.gobanSize;o++){var c=(this.gobanSize-o).toString();this.F.fillText(c,r,n),this.F.fillText(c,e,n),n+=this.G}},t.prototype.B=function(){for(var t=this.isSketch?1:2,i=0;i<t;i++)for(var h=0;h<this.gobanSize;h++)for(var s=0;s<this.gobanSize;s++)this.aa(s,h,i)},t.prototype.aa=function(t,i,h){var s=t*this.G+this.L,a=this.N-i*this.G,o=this.m.ba(t,i);-1!==o.ca&&(0!==h||this.isSketch?this.ea(s,a,o.ca,t,i):this.da(s,a)),(-1===o.ca||1===h||this.isSketch)&&(o.mark&&this.fa(s,a,o),o.label&&this.ga(s,a,o,o.label))},t.prototype.da=function(t,i){var h=.25*this.J,s=this.J-h;this.F.drawImage(this.R,t-s,i-s)},t.prototype.ea=function(t,i,h,s,a){if(this.isSketch)return this.ha(t,i,h,this.J);var o;o=0===h?this.T[this.X[a][s]]:this.V[this.Y[a][s]],this.F.drawImage(o,t-this.J,i-this.J)},t.prototype.ha=function(t,i,h,s){this.F.fillStyle=0===h?"rgb(0,0,0)":"rgb(255,255,255)",this.F.beginPath(),this.F.arc(t,i,.93*s,0,2*Math.PI),this.F.fill()},t.prototype.ia=function(t,i,h,s){if(this.isSketch||-1!==s){var a=.4*this.J;return this.ha(t,i,h,a)}var a=this.J,o=0===h?this.$:this.Z;this.F.drawImage(o,t-a,i-a,2*a,2*a)},t.prototype.S=function(t,i){var h=.1*this.J,s=.95*this.J,a=this.F.createRadialGradient(t,i,s-1-h,t,i,s+h);a.addColorStop(0,"rgba(32,32,32,0.5)"),a.addColorStop(1,"rgba(62,62,62,0)"),this.F.fillStyle=a,this.F.beginPath(),this.F.arc(t,i,s+h,0,2*Math.PI,!0),this.F.fill()},t.prototype.ja=function(t,i,h,s,a,o,r){var e=h/5,n=this.F.createRadialGradient(t-2*e,i-2*e,o*h,t-e,i-e,r*h);n.addColorStop(0,s),n.addColorStop(1,a),this.F.beginPath(),this.F.fillStyle=n,this.F.arc(t,i,.95*h,0,2*Math.PI,!0),this.F.fill()},t.prototype.U=function(t,i,h){var s=.8-.2*Math.random(),a=40*Math.random()+76,o="rgb("+~~(10*Math.random()+a)+","+~~(10*Math.random()+a)+","+~~(10*Math.random()+a)+")";this.ja(t,i,h,o,"#000",.01,s)},t.prototype.W=function(t,i,h){this.ja(t,i,h,"#fff","#aaa",.33,1);var s=e[~~(3*Math.random())],a=2*Math.random()*Math.PI,o=1+1.5*Math.random(),r=.2+.3*Math.random();this.ka(t,i,h,a,s,r,o)},t.prototype.ka=function(t,i,h,s,a,o,r){for(var e=s,n=s,c=0;c<a.length;c++){e+=a[c],n-=a[c];var f=.15*Math.random()+0;this.la(t,i,h,e,n,o,r,f)}},t.prototype.la=function(t,i,h,s,a,o,r,e){var n=this.F;e=~~(100*e)/100,n.strokeStyle="rgba(128,128,128,"+e+")",n.lineWidth=h/30*r,n.beginPath(),h-=Math.max(1,n.lineWidth);var c,f,u,l,p=t+h*Math.cos(s*Math.PI),d=i+h*Math.sin(s*Math.PI),v=t+h*Math.cos(a*Math.PI),g=i+h*Math.sin(a*Math.PI);v>p?(c=(g-d)/(v-p),f=Math.atan(c)):v===p?f=Math.PI/2:(c=(g-d)/(v-p),f=Math.atan(c)-Math.PI);var y=o*h;u=Math.sin(f)*y,l=Math.cos(f)*y;var b=p+u,S=d-l,F=v+u,k=g-l;n.moveTo(p,d),n.bezierCurveTo(b,S,F,k,v,g),n.stroke()},t.prototype.ma=function(t,i,h){switch(h.ca){case-1:if("+"!==h.mark[0]){this._();var s=.8*this.G;this.F.fillRect(t-s/2,i-s/2,s,s)}return"#000";case 0:return"#fff";case 1:return"#000"}},t.prototype.fa=function(t,i,h){switch(h.mark){case"[]":this.F.strokeStyle=this.ma(t,i,h),this.F.lineWidth=2.5,this.F.strokeRect(t-this.K/2,i-this.K/2,this.K,this.K),this.F.lineWidth=1,this.F.strokeStyle="#000";break;case"O":this.F.strokeStyle=this.ma(t,i,h),this.F.lineWidth=2.5,this.F.beginPath(),this.F.arc(t,i,this.K/2,0,2*Math.PI),this.F.stroke(),this.F.lineWidth=1,this.F.strokeStyle="#000";break;case"*":this.F.fillStyle=this.ma(t,i,h),this.F.font=1.5*this.fontSize+"px Arial",this.F.fillText("*",t,i+.35*this.fontSize);break;case"+?":this.F.fillStyle="#888",this.F.fillRect(t-this.K/2,i-this.K/2,this.K,this.K);break;case"+Bo":case"+Wo":this.ia(t,i,"B"===h.mark[1]?0:1,h.ca);break;default:console.error("Unknown mark type: "+h.mark)}},t.prototype.ga=function(t,i,h,s){this.F.fillStyle=this.ma(t,i,h),h.style&&(this.F.fillStyle=h.style);var a=s.replace(r,"").length,o=s.length-a,e=a+.5*o,n=1.2-.2*e,c=Math.max(this.fontSize*n,12);this.F.font=c+"px Arial",this.F.fillText(s,t,i)},t}();h.na=n},{"./wood.js":6}],2:[function(t,i,h){"use strict";h.i=!0;var s=t("./LogicalBoard"),a=t("./BoardRenderer"),o=function(){function t(t){this.oa=new s.pa(t.gobanSize||19),this.qa=new a.na(t),this.canvas=this.qa.l(this.oa)}return t.prototype.render=function(){this.qa.render()},t.prototype.setStoneAt=function(t,i,h){this.oa.setStoneAt(t,i,h)},t.prototype.clearVertexAt=function(t,i){this.oa.clearVertexAt(t,i)},t.prototype.getStoneColorAt=function(t,i){return this.oa.ba(t,i).ca},t.prototype.setLabelAt=function(t,i,h,s){this.oa.setLabelAt(t,i,h,s)},t.prototype.setMarkAt=function(t,i,h){this.oa.setMarkAt(t,i,h)},t.prototype.pixelToGridCoordinates=function(t,i){return this.qa.pixelToGridCoordinates(t,i)},t}();h.Gobo=o},{"./BoardRenderer":1,"./LogicalBoard":3}],3:[function(t,i,h){"use strict";h.i=!0;var s=t("./Vertex"),a=function(){function t(t){this.gobanSize=t,this.ra=new Array(t);for(var i=0;i<t;i++){this.ra[i]=new Array(t);for(var h=0;h<t;h++)this.ra[i][h]=new s.sa}}return t.prototype.ba=function(t,i){var h=this.ra[i][t];if(!h)throw new Error("Invalid coordinates: "+t+","+i);return h},t.prototype.clearVertexAt=function(t,i){this.ba(t,i).clear()},t.prototype.setStoneAt=function(t,i,h){this.ba(t,i).ta(h)},t.prototype.setLabelAt=function(t,i,h,s){var a=this.ba(t,i);a.ua(h),s&&a.va(s)},t.prototype.setMarkAt=function(t,i,h){this.ba(t,i).wa(h)},t}();h.pa=a},{"./Vertex":4}],4:[function(t,i,h){"use strict";h.i=!0;var s=function(){function t(){this.clear()}return t.prototype.clear=function(){this.ca=-1,this.label="",this.mark=""},t.prototype.ta=function(t){this.ca=t},t.prototype.ua=function(t){this.label=t},t.prototype.wa=function(t){this.mark=t},t.prototype.va=function(t){this.style=t},t}();h.sa=s},{}],5:[function(t,i,h){"use strict";var s;h.xa=function(t){if(!(t>=0&&t<=1))throw new Error("Seed must be between 0 and 1");s=t},h.ya=function(){var t=43046721*s+.236067977;return s=t-Math.floor(t)},h.za=function(t,i){return h.ya()*(i-t)+t}},{}],6:[function(t,i,h){function s(){var t=[];t[l]=1;var i=t[p]=u(b[0],b[1]);return t[d]=u(i*S[0],i*S[1]),t}function a(t){for(var i=[0,0,0],h=0;h<3;h++){var s=u(F[0],F[1]);i[h]=t[h]*s}return i}function o(t,i){for(var h=~~(t/v),s=t,a=[],o=h;o>=2;o--){var r=(f()+.5)*(s/o);a.push(r),s-=r,i.push(0)}return a.push(s),a}function r(t,i,h,s,a,o){for(var r=s,e=i.length,n=Math.min(o,a-o)/a,c=0;c<e-1;c++){var u=(f()-.5)*g;h[c]=Math.max(Math.min(h[c]+u,y),-y);var l=(r/(e-c)+(i[c]+h[c]))/2;i[c]=t[c]*(1-n)+l*n,r-=i[c]}i[e-1]=r}function e(t){for(var i=s(),h=a(i),o=u(k[0],k[1]),r=[0,0,0],e=[],n=t-1;n>=0;n--){for(var c=n%2?1-f()*o:0+f()*o,l=0;l<3;l++)r[l]=c*i[l]+(1-c)*h[l];for(var p="#",l=0;l<3;l++)p+=("0"+Math.round(255*r[l]).toString(16)).slice(-2);e[n]=p}return e}function n(t){for(var i=[],h=o(t.width,i),s=h.length,a=e(s),n=h.concat(),c=t.getContext("2d"),f=0;f<t.height;f++){for(var u=0,l=0;l<s;l++){c.fillStyle=a[l];var p=n[l];c.fillRect(u,f,p+1,1),u+=p}r(h,n,i,t.width,t.height,f)}}var c=t("./cheapSeed"),f=c.ya,u=c.za,l=0,p=1,d=2,v=1.2,g=.1,y=.25,b=[.47,.8],S=[.5,.9],F=[.75,.9],k=[.2,.5];h.P=function(t,i){c.xa(i),n(t)}},{"./cheapSeed":5}]},{},[2])(2)});