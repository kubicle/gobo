!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.g)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.h=t()}}(function(){return function t(i,h,s){function e(o,r){if(!h[o]){if(!i[o]){var n="function"==typeof require&&require;if(!r&&n)return n(o,!0);if(a)return a(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var c=h[o]={exports:{}};i[o][0].call(c.exports,function(t){var h=i[o][1][t];return e(h||t)},c,c.exports,t,i,h,s)}return h[o].exports}for(var a="function"==typeof require&&require,o=0;o<s.length;o++)e(s[o]);return e}({1:[function(t,i,h){"use strict";h.i=!0;var s={9:[[5,5]],13:[[4,4],[10,4],[4,10],[10,10]],19:[[4,4],[10,4],[16,4],[4,10],[10,10],[16,10],[4,16],[10,16],[16,16]]},e="#c75",a=5,o=/[.,:;|`'!]/g,r=[[.1,.09,.08,.07,.06,.06,.06,.06,.06,.06,.06],[.1,.12,.11,.1,.09,.09,.09,.09],[.12,.14,.13,.12,.12,.12]],n=function(){function t(t){t=t||{},this.width=t.widthPx,this.height=t.heightPx||t.widthPx,t.widthPx||(console.error("Invalid gobo widthPx: "+t.widthPx),this.width=this.height=100),this.isSketch=!!t.isSketch,this.j=!t.noCoords,this.k=t.marginPx||a;var i=t.background;i.startsWith("#")||i.startsWith("rgb(")?this.backgroundColor=i||e:this.isSketch?this.backgroundColor=e:this.l=i,this.backgroundImage=null}return t.prototype.m=function(t,i){this.o=t,this.p(),this.isSketch||this.q(),this.s(),this.t(i)},t.prototype.render=function(){this.u(),this.v(),this.A(),this.j&&this.B(),this.C()},t.prototype.D=function(){return this.canvas},t.prototype.s=function(){this.F(this.width,this.height),this.G.textAlign="center",this.G.textBaseline="middle"},t.prototype.F=function(t,i){return this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=i,this.G=this.canvas.getContext("2d"),this.canvas},t.prototype.p=function(){var t=Math.min(this.width,this.height);this.gobanSize=this.o.gobanSize,this.j?(this.H=(t-2*this.k)/(this.gobanSize+2),this.H>10?(this.I=10,this.H=(t-2*this.k-2*this.I)/this.gobanSize):this.I=this.H,this.J=this.k+this.I):(this.H=(t-2*this.k)/this.gobanSize,this.J=this.k),this.K=this.H/2,this.L=.55*this.H,this.fontSize=.8*this.H,this.M=Math.round(this.J+this.H/2+(this.width-t)/2),this.N=Math.round(this.J+this.H/2+(this.height-t)/2),this.O=this.N+(this.gobanSize-1)*this.H,this.P=this.M+(this.gobanSize-1)*this.H},t.prototype.pixelToGridCoordinates=function(t,i){return[Math.round((t-this.M)/this.H),Math.round((this.O-i)/this.H)]},t.prototype.t=function(t){if(this.isSketch||!this.l)return t();var i=this.backgroundImage=new Image;i.src=this.l,i.onload=t},t.prototype.q=function(){var t=this.H,i=t/2;this.R=this.F(t,t),this.S(i,i),this.T=[];for(var h=10;h>=0;h--)this.T.push(this.F(t,t)),this.U(i,i,this.K);this.V=[];for(var h=17;h>=0;h--)this.V.push(this.F(t,t)),this.W(i,i,this.K);this.X=[];for(var s=0;s<this.gobanSize;s++)for(var e=this.X[s]=[],h=0;h<this.gobanSize;h++)e.push(~~(11*Math.random()));this.Y=[];for(var s=0;s<this.gobanSize;s++)for(var e=this.Y[s]=[],h=0;h<this.gobanSize;h++){var a=h%3+s%3*3,o=h%6<3==s%6<3?0:1,r=a+9*o;e.push(r)}this.Z=this.F(t,t),this.W(i,i,this.K/2),this.$=this.F(t,t),this.U(i,i,this.K/2)},t.prototype._=function(t,i){var h=new Image;return h.src=this.canvas.toDataURL(),this.G.clearRect(0,0,t,i),h},t.prototype.aa=function(){if(this.l){var t=this.G.createPattern(this.backgroundImage,"repeat");this.G.fillStyle=t}else this.G.fillStyle=this.backgroundColor},t.prototype.u=function(){this.aa(),this.G.fillRect(0,0,this.width,this.height)},t.prototype.v=function(){this.G.strokeStyle="#000",this.G.beginPath();for(var t=0;t<this.gobanSize;t++){var i=this.M+t*this.H;this.G.moveTo(i,this.N),this.G.lineTo(i,this.O);var h=this.N+t*this.H;this.G.moveTo(this.M,h),this.G.lineTo(this.P,h)}this.G.stroke()},t.prototype.A=function(){this.G.fillStyle="#000";var t=s[this.gobanSize];if(t)for(var i=0;i<t.length;i++){var h=t[i],e=(h[0]-1)*this.H+this.M,a=(h[1]-1)*this.H+this.N;this.G.beginPath(),this.G.arc(e,a,this.H/9,0,2*Math.PI),this.G.fill()}},t.prototype.B=function(){this.G.font=this.I+"px Arial";for(var t="ABCDEFGHJKLMNOPQRSTUVWXYZ",i=this.K+this.J/2,h=this.M,s=this.N-i,e=this.O+i,a=0;a<this.gobanSize;a++)this.G.fillText(t[a],h,s),this.G.fillText(t[a],h,e),h+=this.H;for(var o=this.M-i,r=this.P+i,n=this.N,a=0;a<this.gobanSize;a++){var f=(this.gobanSize-a).toString();this.G.fillText(f,o,n),this.G.fillText(f,r,n),n+=this.H}},t.prototype.C=function(){for(var t=this.isSketch?1:2,i=0;i<t;i++)for(var h=0;h<this.gobanSize;h++)for(var s=0;s<this.gobanSize;s++)this.ba(s,h,i)},t.prototype.ba=function(t,i,h){var s=t*this.H+this.M,e=this.O-i*this.H,a=this.o.ca(t,i);-1!==a.da&&(0!==h||this.isSketch?this.fa(s,e,a.da,t,i):this.ea(s,e)),(-1===a.da||1===h||this.isSketch)&&(a.mark&&this.ga(s,e,a),a.label&&this.ha(s,e,a,a.label))},t.prototype.ea=function(t,i){var h=.25*this.K,s=this.K-h;this.G.drawImage(this.R,t-s,i-s)},t.prototype.fa=function(t,i,h,s,e){if(this.isSketch)return this.ia(t,i,h,this.K);var a;a=0===h?this.T[this.X[e][s]]:this.V[this.Y[e][s]],this.G.drawImage(a,t-this.K,i-this.K)},t.prototype.ia=function(t,i,h,s){this.G.fillStyle=0===h?"rgb(0,0,0)":"rgb(255,255,255)",this.G.beginPath(),this.G.arc(t,i,.93*s,0,2*Math.PI),this.G.fill()},t.prototype.ja=function(t,i,h,s){if(this.isSketch||-1!==s){var e=.4*this.K;return this.ia(t,i,h,e)}var e=this.K,a=0===h?this.$:this.Z;this.G.drawImage(a,t-e,i-e,2*e,2*e)},t.prototype.S=function(t,i){var h=.1*this.K,s=.95*this.K,e=this.G.createRadialGradient(t,i,s-1-h,t,i,s+h);e.addColorStop(0,"rgba(32,32,32,0.5)"),e.addColorStop(1,"rgba(62,62,62,0)"),this.G.fillStyle=e,this.G.beginPath(),this.G.arc(t,i,s+h,0,2*Math.PI,!0),this.G.fill()},t.prototype.ka=function(t,i,h,s,e,a,o){var r=h/5,n=this.G.createRadialGradient(t-2*r,i-2*r,a*h,t-r,i-r,o*h);n.addColorStop(0,s),n.addColorStop(1,e),this.G.beginPath(),this.G.fillStyle=n,this.G.arc(t,i,.95*h,0,2*Math.PI,!0),this.G.fill()},t.prototype.U=function(t,i,h){var s=.8-.2*Math.random(),e=40*Math.random()+76,a="rgb("+~~(10*Math.random()+e)+","+~~(10*Math.random()+e)+","+~~(10*Math.random()+e)+")";this.ka(t,i,h,a,"#000",.01,s)},t.prototype.W=function(t,i,h){this.ka(t,i,h,"#fff","#aaa",.33,1);var s=r[~~(3*Math.random())],e=2*Math.random()*Math.PI,a=1+1.5*Math.random(),o=.2+.3*Math.random();this.la(t,i,h,e,s,o,a)},t.prototype.la=function(t,i,h,s,e,a,o){for(var r=s,n=s,f=0;f<e.length;f++){r+=e[f],n-=e[f];var c=.15*Math.random()+0;this.ma(t,i,h,r,n,a,o,c)}},t.prototype.ma=function(t,i,h,s,e,a,o,r){var n=this.G;r=~~(100*r)/100,n.strokeStyle="rgba(128,128,128,"+r+")",n.lineWidth=h/30*o,n.beginPath(),h-=Math.max(1,n.lineWidth);var f,c,l,p,u=t+h*Math.cos(s*Math.PI),d=i+h*Math.sin(s*Math.PI),y=t+h*Math.cos(e*Math.PI),g=i+h*Math.sin(e*Math.PI);y>u?(f=(g-d)/(y-u),c=Math.atan(f)):y===u?c=Math.PI/2:(f=(g-d)/(y-u),c=Math.atan(f)-Math.PI);var v=a*h;l=Math.sin(c)*v,p=Math.cos(c)*v;var G=u+l,S=d-p,b=y+l,k=g-p;n.moveTo(u,d),n.bezierCurveTo(G,S,b,k,y,g),n.stroke()},t.prototype.na=function(t,i,h){switch(h.da){case-1:if("+"!==h.mark[0]){this.aa();var s=.8*this.H;this.G.fillRect(t-s/2,i-s/2,s,s)}return"#000";case 0:return"#fff";case 1:return"#000"}},t.prototype.ga=function(t,i,h){switch(h.mark){case"[]":this.G.strokeStyle=this.na(t,i,h),this.G.lineWidth=2.5,this.G.strokeRect(t-this.L/2,i-this.L/2,this.L,this.L),this.G.lineWidth=1,this.G.strokeStyle="#000";break;case"O":this.G.strokeStyle=this.na(t,i,h),this.G.lineWidth=2.5,this.G.beginPath(),this.G.arc(t,i,this.L/2,0,2*Math.PI),this.G.stroke(),this.G.lineWidth=1,this.G.strokeStyle="#000";break;case"*":this.G.fillStyle=this.na(t,i,h),this.G.font=1.5*this.fontSize+"px Arial",this.G.fillText("*",t,i+.35*this.fontSize);break;case"+?":this.G.fillStyle="#888",this.G.fillRect(t-this.L/2,i-this.L/2,this.L,this.L);break;case"+Bo":case"+Wo":this.ja(t,i,"B"===h.mark[1]?0:1,h.da);break;default:console.error("Unknown mark type: "+h.mark)}},t.prototype.ha=function(t,i,h,s){this.G.fillStyle=this.na(t,i,h),h.style&&(this.G.fillStyle=h.style);var e=s.replace(o,"").length,a=s.length-e,r=e+.5*a,n=1.2-.2*r,f=Math.max(this.fontSize*n,12);this.G.font=f+"px Arial",this.G.fillText(s,t,i)},t}();h.oa=n},{}],2:[function(t,i,h){"use strict";h.i=!0;var s=t("./LogicalBoard"),e=t("./BoardRenderer"),a=function(){function t(t,i){this.parent=t,t.textContent="",i.widthPx=i.widthPx||t.clientWidth,this.pa=new s.qa(i.gobanSize||19),this.ra=new e.oa(i)}return t.prototype.prepareRenderer=function(t){var i=this;this.ra.m(this.pa,function(){var h=i.ra.D();i.parent.appendChild(h),t(null,h)})},t.prototype.render=function(){this.ra.render()},t.prototype.setStoneAt=function(t,i,h){this.pa.setStoneAt(t,i,h)},t.prototype.clearVertexAt=function(t,i){this.pa.clearVertexAt(t,i)},t.prototype.getStoneColorAt=function(t,i){return this.pa.ca(t,i).da},t.prototype.setLabelAt=function(t,i,h,s){this.pa.setLabelAt(t,i,h,s)},t.prototype.setMarkAt=function(t,i,h){this.pa.setMarkAt(t,i,h)},t.prototype.pixelToGridCoordinates=function(t,i){return this.ra.pixelToGridCoordinates(t,i)},t}();h.Gobo=a},{"./BoardRenderer":1,"./LogicalBoard":3}],3:[function(t,i,h){"use strict";h.i=!0;var s=t("./Vertex"),e=function(){function t(t){this.gobanSize=t,this.sa=new Array(t);for(var i=0;i<t;i++){this.sa[i]=new Array(t);for(var h=0;h<t;h++)this.sa[i][h]=new s.ta}}return t.prototype.ca=function(t,i){var h=this.sa[i][t];if(!h)throw new Error("Invalid coordinates: "+t+","+i);return h},t.prototype.clearVertexAt=function(t,i){this.ca(t,i).clear()},t.prototype.setStoneAt=function(t,i,h){this.ca(t,i).ua(h)},t.prototype.setLabelAt=function(t,i,h,s){var e=this.ca(t,i);e.va(h),s&&e.wa(s)},t.prototype.setMarkAt=function(t,i,h){this.ca(t,i).xa(h)},t}();h.qa=e},{"./Vertex":4}],4:[function(t,i,h){"use strict";h.i=!0;var s=function(){function t(){this.clear()}return t.prototype.clear=function(){this.da=-1,this.label="",this.mark=""},t.prototype.ua=function(t){this.da=t},t.prototype.va=function(t){this.label=t},t.prototype.xa=function(t){this.mark=t},t.prototype.wa=function(t){this.style=t},t}();h.ta=s},{}]},{},[2])(2)});