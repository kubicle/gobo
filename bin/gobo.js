!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.g)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.gobo=t()}}(function(){return function t(i,h,e){function s(a,r){if(!h[a]){if(!i[a]){var n="function"==typeof require&&require;if(!r&&n)return n(a,!0);if(o)return o(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var c=h[a]={exports:{}};i[a][0].call(c.exports,function(t){var h=i[a][1][t];return s(h||t)},c,c.exports,t,i,h,e)}return h[a].exports}for(var o="function"==typeof require&&require,a=0;a<e.length;a++)s(e[a]);return s}({1:[function(t,i,h){"use strict";h.h=!0;var e=t("./wood.js"),s=t("./cheapSeed"),o={9:[[5,5]],13:[[4,4],[10,4],[4,10],[10,10]],19:[[4,4],[10,4],[16,4],[4,10],[10,10],[16,10],[4,16],[10,16],[16,16]]},a=5,r=/[.,:;|`'!]/g,n=[[.1,.09,.08,.07,.06,.06,.06,.06,.06,.06,.06],[.1,.12,.11,.1,.09,.09,.09,.09],[.12,.14,.13,.12,.12,.12]],f=function(){function t(t){this.pixelRatio=t.pixelRatio||1,this.width=t.widthPx*this.pixelRatio,this.height=(t.heightPx||t.widthPx)*this.pixelRatio,t.widthPx||(console.error("Invalid gobo widthPx: "+t.widthPx),this.width=this.height=100),this.isSketch=!!t.isSketch,this.i=!t.noCoords,this.j=(t.marginPx||a)*this.pixelRatio,this.backgroundCanvas=t.backgroundCanvas,this.background=t.background,this.patternSeed=t.patternSeed||Math.random()}return t.prototype.k=function(t){return this.l=t,this.m(),this.isSketch||(s.o(this.patternSeed),this.p()),s.o(this.patternSeed),this.q(),this.s(),this.canvas},t.prototype.render=function(){this.t(),this.u(),this.v(),this.i&&this.A(),this.B()},t.prototype.C=function(){return this.canvas},t.prototype.q=function(){this.canvas=this.D(this.width,this.height),this.F.textAlign="center",this.F.textBaseline="middle"},t.prototype.D=function(t,i){var h=document.createElement("canvas");return h.width=t,h.height=i,this.F=h.getContext("2d"),h},t.prototype.m=function(){var t=Math.min(this.width,this.height);this.gobanSize=this.l.gobanSize,this.i?(this.G=(t-2*this.j)/(this.gobanSize+2),this.G>10*this.pixelRatio?(this.H=10*this.pixelRatio,this.G=(t-2*this.j-2*this.H)/this.gobanSize):this.H=this.G,this.I=this.j+this.H):(this.G=(t-2*this.j)/this.gobanSize,this.I=this.j),this.J=this.G/2,this.K=.55*this.G,this.fontSize=.8*this.G,this.L=Math.round(this.I+this.G/2+(this.width-t)/2),this.M=Math.round(this.I+this.G/2+(this.height-t)/2),this.N=this.M+(this.gobanSize-1)*this.G,this.O=this.L+(this.gobanSize-1)*this.G},t.prototype.pixelToGridCoordinates=function(t,i){return[Math.round((t-this.L)/this.G),Math.round((this.N-i)/this.G)]},t.prototype.s=function(){if(!this.backgroundCanvas)if(this.background){if("#"===this.background[0]||"rgb"===this.background.substr(0,3).toLowerCase())this.backgroundColor=this.background;else if("wood"===this.background){if(this.isSketch||this.backgroundCanvas)return;var t=this.backgroundCanvas=document.createElement("canvas");t.width=t.height=200*this.pixelRatio,e.P(t)}}else this.backgroundColor="#c75"},t.prototype.p=function(){var t=this.G,i=t/2;this.R=this.D(t,t),this.S(i,i),this.T=[];for(var h=10;h>=0;h--)this.T.push(this.D(t,t)),this.U(i,i,this.J);this.V=[];for(var h=17;h>=0;h--)this.V.push(this.D(t,t)),this.W(i,i,this.J);this.X=[];for(var e=0;e<this.gobanSize;e++)for(var o=this.X[e]=[],h=0;h<this.gobanSize;h++)o.push(~~(11*s.Y()));this.Z=[];for(var e=0;e<this.gobanSize;e++)for(var o=this.Z[e]=[],h=0;h<this.gobanSize;h++){var a=h%3+e%3*3,r=h%6<3==e%6<3?0:1,n=a+9*r;o.push(n)}this.$=this.D(t,t),this.W(i,i,this.J/2),this._=this.D(t,t),this.U(i,i,this.J/2)},t.prototype.aa=function(){this.backgroundCanvas?this.F.fillStyle=this.F.createPattern(this.backgroundCanvas,"repeat"):this.F.fillStyle=this.backgroundColor},t.prototype.t=function(){this.aa(),this.F.fillRect(0,0,this.width,this.height)},t.prototype.u=function(){this.F.strokeStyle="#000",this.F.lineWidth=1,this.F.beginPath();for(var t=0;t<this.gobanSize;t++){var i=this.L+t*this.G;this.F.moveTo(i,this.M),this.F.lineTo(i,this.N);var h=this.M+t*this.G;this.F.moveTo(this.L,h),this.F.lineTo(this.O,h)}this.F.stroke()},t.prototype.v=function(){this.F.fillStyle="#000";var t=o[this.gobanSize];if(t)for(var i=0;i<t.length;i++){var h=t[i],e=(h[0]-1)*this.G+this.L,s=(h[1]-1)*this.G+this.M;this.F.beginPath(),this.F.arc(e,s,this.G/9,0,2*Math.PI),this.F.fill()}},t.prototype.A=function(){this.F.fillStyle="#000",this.F.font=this.H+"px Arial";for(var t="ABCDEFGHJKLMNOPQRSTUVWXYZ",i=this.J+this.I/2,h=this.L,e=this.M-i,s=this.N+i,o=0;o<this.gobanSize;o++)this.F.fillText(t[o],h,e),this.F.fillText(t[o],h,s),h+=this.G;for(var a=this.L-i,r=this.O+i,n=this.M,o=0;o<this.gobanSize;o++){var f=(this.gobanSize-o).toString();this.F.fillText(f,a,n),this.F.fillText(f,r,n),n+=this.G}},t.prototype.B=function(){for(var t=this.isSketch?1:2,i=0;i<t;i++)for(var h=0;h<this.gobanSize;h++)for(var e=0;e<this.gobanSize;e++)this.ba(e,h,i)},t.prototype.ba=function(t,i,h){var e=t*this.G+this.L,s=this.N-i*this.G,o=this.l.ca(t,i);-1!==o.da&&(0!==h||this.isSketch?this.fa(e,s,o.da,t,i):this.ea(e,s)),(-1===o.da||1===h||this.isSketch)&&(o.mark&&this.ga(e,s,o),o.label&&this.ha(e,s,o,o.label))},t.prototype.ea=function(t,i){var h=.25*this.J,e=this.J-h;this.F.drawImage(this.R,t-e,i-e)},t.prototype.fa=function(t,i,h,e,s){if(this.isSketch)return this.ia(t,i,h,this.J);var o;o=0===h?this.T[this.X[s][e]]:this.V[this.Z[s][e]],this.F.drawImage(o,t-this.J,i-this.J)},t.prototype.ia=function(t,i,h,e){this.F.fillStyle=0===h?"rgb(0,0,0)":"rgb(255,255,255)",this.F.beginPath(),this.F.arc(t,i,.93*e,0,2*Math.PI),this.F.fill()},t.prototype.ja=function(t,i,h,e){if(this.isSketch||-1!==e){var s=.4*this.J;return this.ia(t,i,h,s)}var s=this.J,o=0===h?this._:this.$;this.F.drawImage(o,t-s,i-s,2*s,2*s)},t.prototype.S=function(t,i){var h=.1*this.J,e=.95*this.J,s=this.F.createRadialGradient(t,i,e-1-h,t,i,e+h);s.addColorStop(0,"rgba(32,32,32,0.5)"),s.addColorStop(1,"rgba(62,62,62,0)"),this.F.fillStyle=s,this.F.beginPath(),this.F.arc(t,i,e+h,0,2*Math.PI,!0),this.F.fill()},t.prototype.ka=function(t,i,h,e,s,o,a){var r=h/5,n=this.F.createRadialGradient(t-2*r,i-2*r,o*h,t-r,i-r,a*h);n.addColorStop(0,e),n.addColorStop(1,s),this.F.beginPath(),this.F.fillStyle=n,this.F.arc(t,i,.95*h,0,2*Math.PI,!0),this.F.fill()},t.prototype.U=function(t,i,h){var e=.8-.2*s.Y(),o=40*s.Y()+76,a="rgb("+~~(10*s.Y()+o)+","+~~(10*s.Y()+o)+","+~~(10*s.Y()+o)+")";this.ka(t,i,h,a,"#000",.01,e)},t.prototype.W=function(t,i,h){this.ka(t,i,h,"#fff","#aaa",.33,1);var e=n[~~(3*s.Y())],o=2*s.Y()*Math.PI,a=1+1.5*s.Y(),r=.2+.3*s.Y();this.la(t,i,h,o,e,r,a)},t.prototype.la=function(t,i,h,e,o,a,r){for(var n=e,f=e,c=0;c<o.length;c++){n+=o[c],f-=o[c];var l=.15*s.Y()+0;this.ma(t,i,h,n,f,a,r,l)}},t.prototype.ma=function(t,i,h,e,s,o,a,r){var n=this.F;r=~~(100*r)/100,n.strokeStyle="rgba(128,128,128,"+r+")",n.lineWidth=h/30*a,n.beginPath(),h-=Math.max(1,n.lineWidth);var f,c,l,u,p=t+h*Math.cos(e*Math.PI),d=i+h*Math.sin(e*Math.PI),v=t+h*Math.cos(s*Math.PI),g=i+h*Math.sin(s*Math.PI);v>p?(f=(g-d)/(v-p),c=Math.atan(f)):v===p?c=Math.PI/2:(f=(g-d)/(v-p),c=Math.atan(f)-Math.PI);var y=o*h;l=Math.sin(c)*y,u=Math.cos(c)*y;var b=p+l,S=d-u,k=v+l,F=g-u;n.moveTo(p,d),n.bezierCurveTo(b,S,k,F,v,g),n.stroke()},t.prototype.na=function(t,i,h){switch(h.da){case-1:if("+"!==h.mark[0]){this.aa();var e=.8*this.G;this.F.fillRect(t-e/2,i-e/2,e,e)}return"#000";case 0:return"#fff";case 1:return"#000"}},t.prototype.ga=function(t,i,h){var e=this.F,s=h.mark.split(":"),o=s[0],a=s.length>1?s[1].split(","):[],r=(parseInt(a[0])/10||1)*this.K,n=r/2,f=(parseInt(a[1])||5)*r/24;switch(o){case"[]":e.strokeStyle=this.na(t,i,h),e.lineWidth=f,e.strokeRect(t-n,i-n,r,r);break;case"O":e.strokeStyle=this.na(t,i,h),e.lineWidth=f,e.beginPath(),e.arc(t,i,n,0,2*Math.PI),e.stroke();break;case"*":e.fillStyle=this.na(t,i,h),e.font=1.5*this.fontSize+"px Arial",e.fillText("*",t,i+.35*this.fontSize);break;case"+":e.strokeStyle=this.na(t,i,h),e.lineWidth=f,e.beginPath(),e.moveTo(t-n,i),e.lineTo(t+n,i),e.moveTo(t,i-n),e.lineTo(t,i+n),e.stroke();break;case"+?":e.fillStyle="#888",e.fillRect(t-n,i-n,r,r);break;case"+Bo":case"+Wo":this.ja(t,i,"B"===o[1]?0:1,h.da);break;default:console.error("Unknown mark type: "+h.mark)}},t.prototype.ha=function(t,i,h,e){this.F.fillStyle=this.na(t,i,h),h.style&&(this.F.fillStyle=h.style);var s=e.replace(r,"").length,o=e.length-s,a=s+.5*o,n=1.2-.2*a,f=Math.max(this.fontSize*n,12*this.pixelRatio);this.F.font=f+"px Arial",this.F.fillText(e,t,i)},t}();h.oa=f},{"./cheapSeed":5,"./wood.js":6}],2:[function(t,i,h){"use strict";h.h=!0;var e=t("./LogicalBoard"),s=t("./BoardRenderer"),o=function(){function t(t){this.pa=new e.qa(t.gobanSize||19),this.ra=new s.oa(t),this.canvas=this.ra.k(this.pa)}return t.prototype.render=function(){this.ra.render()},t.prototype.setStoneAt=function(t,i,h){this.pa.setStoneAt(t,i,h)},t.prototype.clearVertexAt=function(t,i){this.pa.clearVertexAt(t,i)},t.prototype.getStoneColorAt=function(t,i){return this.pa.ca(t,i).da},t.prototype.setLabelAt=function(t,i,h,e){this.pa.setLabelAt(t,i,h,e)},t.prototype.setMarkAt=function(t,i,h){this.pa.setMarkAt(t,i,h)},t.prototype.pixelToGridCoordinates=function(t,i){return this.ra.pixelToGridCoordinates(t,i)},t}();h.Gobo=o},{"./BoardRenderer":1,"./LogicalBoard":3}],3:[function(t,i,h){"use strict";h.h=!0;var e=t("./Vertex"),s=function(){function t(t){this.gobanSize=t,this.sa=new Array(t);for(var i=0;i<t;i++){this.sa[i]=new Array(t);for(var h=0;h<t;h++)this.sa[i][h]=new e.ta}}return t.prototype.ca=function(t,i){var h=this.sa[i][t];if(!h)throw new Error("Invalid coordinates: "+t+","+i);return h},t.prototype.clearVertexAt=function(t,i){this.ca(t,i).clear()},t.prototype.setStoneAt=function(t,i,h){this.ca(t,i).ua(h)},t.prototype.setLabelAt=function(t,i,h,e){var s=this.ca(t,i);s.va(h),e&&s.wa(e)},t.prototype.setMarkAt=function(t,i,h){this.ca(t,i).xa(h)},t}();h.qa=s},{"./Vertex":4}],4:[function(t,i,h){"use strict";h.h=!0;var e=function(){function t(){this.clear()}return t.prototype.clear=function(){this.da=-1,this.label="",this.mark=""},t.prototype.ua=function(t){this.da=t},t.prototype.va=function(t){this.label=t},t.prototype.xa=function(t){this.mark=t},t.prototype.wa=function(t){this.style=t},t}();h.ta=e},{}],5:[function(t,i,h){"use strict";var e;h.o=function(t){if(!(t>=0&&t<=1))throw new Error("Seed must be between 0 and 1");e=t},h.Y=function(){var t=43046721*e+.236067977;return e=t-Math.floor(t)},h.ya=function(t,i){return h.Y()*(i-t)+t}},{}],6:[function(t,i,h){function e(){var t=[];t[d]=1;var i=t[v]=p(F[0],F[1]);return t[g]=p(i*x[0],i*x[1]),t}function s(t){for(var i=[0,0,0],h=p(M[0],M[1]),e=0;e<3;e++)i[e]=t[e]*h;return i}function o(t,i){for(var h=~~(t/f),e=t,s=[],o=h;o>=2;o--){var a=(u()+.5)*(e/o);s.push(a),e-=a,i.push(0)}return s.push(e),s}function a(t,i,h,e,s,o){for(var a=e,r=i.length,n=Math.max((o-s)/k+1,0),l=0;l<r-1;l++){var p=(l+.5)*f,d=e-a+i[l]/2,v=Math.max((d-e)/S+1,0),g=Math.min(Math.abs(d-p)/c,1),F=h[l];F=F*(1-g)+(u()-.5)*b,h[l]=F=Math.max(Math.min(F,y),-y);var x=i[l]+F;x=a/(r-l)*v+x*(1-v);var M=t[l]*n+x*(1-n);i[l]=M,a-=M}i[r-1]=a}function r(t){for(var i=e(),h=s(i),o=p(w[0],w[1]),a=[0,0,0],r=[],n=t-1;n>=0;n--){for(var f=n%2?1-u()*o:0+u()*o,c=0;c<3;c++)a[c]=f*i[c]+(1-f)*h[c];for(var l="#",c=0;c<3;c++)l+=("0"+Math.round(255*a[c]).toString(16)).slice(-2);r[n]=l}return r}function n(t){f=p(1.2,2.4),c=p(1,2.5)*f;for(var i=[],h=o(t.width,i),e=h.length,s=r(e),n=h.concat(),l=t.getContext("2d"),u=0;u<t.height;u++){for(var d=0,v=0;v<e;v++){l.fillStyle=s[v];var g=n[v];l.fillRect(d,u,g+1,1),d+=g}a(h,n,i,t.width,t.height,u)}}var f,c,l=t("./cheapSeed"),u=l.Y,p=l.ya,d=0,v=1,g=2,y=.12,b=y/8,S=30,k=100,F=[.4,.85],x=[.6,.9],M=[.75,.9],w=[.2,.5];h.P=function(t){n(t)}},{"./cheapSeed":5}]},{},[2])(2)});