!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.g)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.gobo=t()}}(function(){return function t(i,e,h){function s(o,r){if(!e[o]){if(!i[o]){var n="function"==typeof require&&require;if(!r&&n)return n(o,!0);if(a)return a(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var c=e[o]={exports:{}};i[o][0].call(c.exports,function(t){var e=i[o][1][t];return s(e||t)},c,c.exports,t,i,e,h)}return e[o].exports}for(var a="function"==typeof require&&require,o=0;o<h.length;o++)s(h[o]);return s}({1:[function(t,i,e){"use strict";e.h=!0;var h=t("./wood.js"),s=t("./cheapSeed"),a={9:[[5,5]],13:[[4,4],[10,4],[4,10],[10,10]],19:[[4,4],[10,4],[16,4],[4,10],[10,10],[16,10],[4,16],[10,16],[16,16]]},o=5,r=/[.,:;|`'!]/g,n=[[.1,.09,.08,.07,.06,.06,.06,.06,.06,.06,.06],[.1,.12,.11,.1,.09,.09,.09,.09],[.12,.14,.13,.12,.12,.12]],f=function(){function t(t){this.pixelRatio=Math.max(1,t.pixelRatio||1),this.isSketch=!!t.isSketch,this.i=!t.noCoords,this.j=(t.marginPx||o)*this.pixelRatio,this.backgroundCanvas=t.backgroundCanvas,this.background=t.background,this.patternSeed=t.patternSeed||Math.random(),this.k(t.widthPx,t.heightPx)}return t.prototype.k=function(t,i){t||(console.error("Invalid gobo widthPx: "+t),t=100);var e=t*this.pixelRatio,h=(i||t)*this.pixelRatio;return(e!==this.width||h!==this.height)&&(this.width=e,this.height=h,!0)},t.prototype.l=function(t){return this.m=t,this.o(),this.isSketch||this.p(),this.q(),this.s(),this.t(),this.canvas},t.prototype.resize=function(t,i){this.k(t,i)&&(this.o(),this.isSketch||this.p(),this.canvas.width=this.width,this.canvas.height=this.height,this.t())},t.prototype.render=function(){this.u(),this.v(),this.A(),this.i&&this.B(),this.C()},t.prototype.D=function(){return this.canvas},t.prototype.s=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height},t.prototype.t=function(){this.F=this.canvas.getContext("2d"),this.F.textAlign="center",this.F.textBaseline="middle"},t.prototype.G=function(t,i){var e=document.createElement("canvas");return e.width=t,e.height=i,this.F=e.getContext("2d"),e},t.prototype.o=function(){var t=Math.min(this.width,this.height);this.gobanSize=this.m.gobanSize,this.i?(this.H=(t-2*this.j)/(this.gobanSize+2),this.H>10*this.pixelRatio?(this.I=10*this.pixelRatio,this.H=(t-2*this.j-2*this.I)/this.gobanSize):this.I=this.H,this.J=this.j+this.I):(this.H=(t-2*this.j)/this.gobanSize,this.J=this.j),this.K=this.H/2,this.L=.55*this.H,this.fontSize=.8*this.H,this.M=Math.round(this.J+this.H/2+(this.width-t)/2),this.N=Math.round(this.J+this.H/2+(this.height-t)/2),this.O=this.N+(this.gobanSize-1)*this.H,this.P=this.M+(this.gobanSize-1)*this.H},t.prototype.pixelToGridCoordinates=function(t,i){return[Math.round((t-this.M)/this.H),Math.round((this.O-i)/this.H)]},t.prototype.q=function(){if(!this.backgroundCanvas)if(this.background){if("#"===this.background[0]||"rgb"===this.background.substr(0,3).toLowerCase())this.backgroundColor=this.background;else if("wood"===this.background){if(this.isSketch||this.backgroundCanvas)return;var t=this.backgroundCanvas=document.createElement("canvas");t.width=t.height=200*this.pixelRatio,h.R(t,this.patternSeed,this.patternSeed,this.pixelRatio)}}else this.backgroundColor="#c75"},t.prototype.p=function(){s.S(this.patternSeed);var t=this.H,i=t/2;this.T=this.G(t,t),this.U(i,i),this.V=[];for(var e=10;e>=0;e--)this.V.push(this.G(t,t)),this.W(i,i,this.K);this.X=[];for(var e=17;e>=0;e--)this.X.push(this.G(t,t)),this.Y(i,i,this.K);this.Z=[];for(var h=0;h<this.gobanSize;h++)for(var a=this.Z[h]=[],e=0;e<this.gobanSize;e++)a.push(~~(11*s.$()));this._=[];for(var h=0;h<this.gobanSize;h++)for(var a=this._[h]=[],e=0;e<this.gobanSize;e++){var o=e%3+h%3*3,r=e%6<3==h%6<3?0:1,n=o+9*r;a.push(n)}this.aa=this.G(t,t),this.Y(i,i,this.K/2),this.ba=this.G(t,t),this.W(i,i,this.K/2)},t.prototype.ca=function(){this.backgroundCanvas?this.F.fillStyle=this.F.createPattern(this.backgroundCanvas,"repeat"):this.F.fillStyle=this.backgroundColor},t.prototype.u=function(){this.ca(),this.F.fillRect(0,0,this.width,this.height)},t.prototype.v=function(){this.F.strokeStyle="#000",this.F.lineWidth=1,this.F.beginPath();for(var t=0;t<this.gobanSize;t++){var i=this.M+t*this.H;this.F.moveTo(i,this.N),this.F.lineTo(i,this.O);var e=this.N+t*this.H;this.F.moveTo(this.M,e),this.F.lineTo(this.P,e)}this.F.stroke()},t.prototype.A=function(){this.F.fillStyle="#000";var t=a[this.gobanSize];if(t)for(var i=0;i<t.length;i++){var e=t[i],h=(e[0]-1)*this.H+this.M,s=(e[1]-1)*this.H+this.N;this.F.beginPath(),this.F.arc(h,s,this.H/9,0,2*Math.PI),this.F.fill()}},t.prototype.B=function(){this.F.fillStyle="#000",this.F.font=this.I+"px Arial";for(var t="ABCDEFGHJKLMNOPQRSTUVWXYZ",i=this.K+this.J/2,e=this.M,h=this.N-i,s=this.O+i,a=0;a<this.gobanSize;a++)this.F.fillText(t[a],e,h),this.F.fillText(t[a],e,s),e+=this.H;for(var o=this.M-i,r=this.P+i,n=this.N,a=0;a<this.gobanSize;a++){var f=(this.gobanSize-a).toString();this.F.fillText(f,o,n),this.F.fillText(f,r,n),n+=this.H}},t.prototype.C=function(){for(var t=this.isSketch?1:2,i=0;i<t;i++)for(var e=0;e<this.gobanSize;e++)for(var h=0;h<this.gobanSize;h++)this.da(h,e,i)},t.prototype.da=function(t,i,e){var h=t*this.H+this.M,s=this.O-i*this.H,a=this.m.ea(t,i);-1!==a.fa&&(0!==e||this.isSketch?this.ha(h,s,a.fa,t,i):this.ga(h,s)),(-1===a.fa||1===e||this.isSketch)&&(a.mark&&this.ia(h,s,a),a.label&&this.ja(h,s,a,a.label))},t.prototype.ga=function(t,i){var e=.25*this.K,h=this.K-e;this.F.drawImage(this.T,t-h,i-h)},t.prototype.ha=function(t,i,e,h,s){if(this.isSketch)return this.ka(t,i,e,this.K);var a;a=0===e?this.V[this.Z[s][h]]:this.X[this._[s][h]],this.F.drawImage(a,t-this.K,i-this.K)},t.prototype.ka=function(t,i,e,h){this.F.fillStyle=0===e?"rgb(0,0,0)":"rgb(255,255,255)",this.F.beginPath(),this.F.arc(t,i,.93*h,0,2*Math.PI),this.F.fill()},t.prototype.la=function(t,i,e,h){if(this.isSketch||-1!==h){var s=.4*this.K;return this.ka(t,i,e,s)}var s=this.K,a=0===e?this.ba:this.aa;this.F.drawImage(a,t-s,i-s,2*s,2*s)},t.prototype.U=function(t,i){var e=.1*this.K,h=.95*this.K,s=this.F.createRadialGradient(t,i,h-1-e,t,i,h+e);s.addColorStop(0,"rgba(32,32,32,0.5)"),s.addColorStop(1,"rgba(62,62,62,0)"),this.F.fillStyle=s,this.F.beginPath(),this.F.arc(t,i,h+e,0,2*Math.PI,!0),this.F.fill()},t.prototype.ma=function(t,i,e,h,s,a,o){var r=e/5,n=this.F.createRadialGradient(t-2*r,i-2*r,a*e,t-r,i-r,o*e);n.addColorStop(0,h),n.addColorStop(1,s),this.F.beginPath(),this.F.fillStyle=n,this.F.arc(t,i,.95*e,0,2*Math.PI,!0),this.F.fill()},t.prototype.W=function(t,i,e){var h=.8-.2*s.$(),a=40*s.$()+76,o="rgb("+~~(10*s.$()+a)+","+~~(10*s.$()+a)+","+~~(10*s.$()+a)+")";this.ma(t,i,e,o,"#000",.01,h)},t.prototype.Y=function(t,i,e){this.ma(t,i,e,"#fff","#aaa",.33,1);var h=n[~~(3*s.$())],a=2*s.$()*Math.PI,o=(1+1.5*s.$())*this.pixelRatio,r=.2+.3*s.$();this.na(t,i,e,a,h,r,o)},t.prototype.na=function(t,i,e,h,a,o,r){for(var n=h,f=h,c=0;c<a.length;c++){n+=a[c],f-=a[c];var l=.15*s.$()+0;this.oa(t,i,e,n,f,o,r,l)}},t.prototype.oa=function(t,i,e,h,s,a,o,r){var n=this.F;r=~~(100*r)/100,n.strokeStyle="rgba(128,128,128,"+r+")",n.lineWidth=e/30*o,n.beginPath(),e-=Math.max(1,n.lineWidth);var f,c,l,u,p=t+e*Math.cos(h*Math.PI),d=i+e*Math.sin(h*Math.PI),v=t+e*Math.cos(s*Math.PI),g=i+e*Math.sin(s*Math.PI);v>p?(f=(g-d)/(v-p),c=Math.atan(f)):v===p?c=Math.PI/2:(f=(g-d)/(v-p),c=Math.atan(f)-Math.PI);var y=a*e;l=Math.sin(c)*y,u=Math.cos(c)*y;var b=p+l,S=d-u,k=v+l,F=g-u;n.moveTo(p,d),n.bezierCurveTo(b,S,k,F,v,g),n.stroke()},t.prototype.pa=function(t,i,e){switch(e.fa){case-1:if("+"!==e.mark[0]){this.ca();var h=.8*this.H;this.F.fillRect(t-h/2,i-h/2,h,h)}return"#000";case 0:return"#fff";case 1:return"#000"}},t.prototype.ia=function(t,i,e){var h=this.F,s=e.mark.split(":"),a=s[0],o=s.length>1?s[1].split(","):[],r=(parseInt(o[0])/10||1)*this.L,n=r/2,f=(parseInt(o[1])||5)*r/24;switch(a){case"[]":h.strokeStyle=this.pa(t,i,e),h.lineWidth=f,h.strokeRect(t-n,i-n,r,r);break;case"O":h.strokeStyle=this.pa(t,i,e),h.lineWidth=f,h.beginPath(),h.arc(t,i,n,0,2*Math.PI),h.stroke();break;case"*":h.fillStyle=this.pa(t,i,e),h.font=1.5*this.fontSize+"px Arial",h.fillText("*",t,i+.35*this.fontSize);break;case"+":h.strokeStyle=this.pa(t,i,e),h.lineWidth=f,h.beginPath(),h.moveTo(t-n,i),h.lineTo(t+n,i),h.moveTo(t,i-n),h.lineTo(t,i+n),h.stroke();break;case"+?":h.fillStyle="#888",h.fillRect(t-n,i-n,r,r);break;case"+Bo":case"+Wo":this.la(t,i,"B"===a[1]?0:1,e.fa);break;default:console.error("Unknown mark type: "+e.mark)}},t.prototype.ja=function(t,i,e,h){this.F.fillStyle=this.pa(t,i,e),e.style&&(this.F.fillStyle=e.style);var s=h.replace(r,"").length,a=h.length-s,o=s+.5*a,n=1.2-.2*o,f=Math.max(this.fontSize*n,12*this.pixelRatio);this.F.font=f+"px Arial",this.F.fillText(h,t,i)},t}();e.qa=f},{"./cheapSeed":5,"./wood.js":6}],2:[function(t,i,e){"use strict";e.h=!0;var h=t("./LogicalBoard"),s=t("./BoardRenderer"),a=function(){function t(t){this.ra=new h.sa(t.gobanSize||19),this.ta=new s.qa(t),this.canvas=this.ta.l(this.ra)}return t.prototype.resize=function(t,i){this.ta.resize(t,i)},t.prototype.render=function(){this.ta.render()},t.prototype.setStoneAt=function(t,i,e){this.ra.setStoneAt(t,i,e)},t.prototype.clearVertexAt=function(t,i){this.ra.clearVertexAt(t,i)},t.prototype.getStoneColorAt=function(t,i){return this.ra.ea(t,i).fa},t.prototype.setLabelAt=function(t,i,e,h){this.ra.setLabelAt(t,i,e,h)},t.prototype.setMarkAt=function(t,i,e){this.ra.setMarkAt(t,i,e)},t.prototype.pixelToGridCoordinates=function(t,i){return this.ta.pixelToGridCoordinates(t,i)},t}();e.Gobo=a},{"./BoardRenderer":1,"./LogicalBoard":3}],3:[function(t,i,e){"use strict";e.h=!0;var h=t("./Vertex"),s=function(){function t(t){this.gobanSize=t,this.ua=new Array(t);for(var i=0;i<t;i++){this.ua[i]=new Array(t);for(var e=0;e<t;e++)this.ua[i][e]=new h.va}}return t.prototype.ea=function(t,i){var e=this.ua[i][t];if(!e)throw new Error("Invalid coordinates: "+t+","+i);return e},t.prototype.clearVertexAt=function(t,i){this.ea(t,i).clear()},t.prototype.setStoneAt=function(t,i,e){this.ea(t,i).wa(e)},t.prototype.setLabelAt=function(t,i,e,h){var s=this.ea(t,i);s.xa(e),h&&s.ya(h)},t.prototype.setMarkAt=function(t,i,e){this.ea(t,i).za(e)},t}();e.sa=s},{"./Vertex":4}],4:[function(t,i,e){"use strict";e.h=!0;var h=function(){function t(){this.clear()}return t.prototype.clear=function(){this.fa=-1,this.label="",this.mark=""},t.prototype.wa=function(t){this.fa=t},t.prototype.xa=function(t){this.label=t},t.prototype.za=function(t){this.mark=t},t.prototype.ya=function(t){this.style=t},t}();e.va=h},{}],5:[function(t,i,e){"use strict";var h;e.S=function(t){if(!(t>=0&&t<=1))throw new Error("Seed must be between 0 and 1");h=t},e.$=function(){var t=43046721*h+.236067977;return h=t-Math.floor(t)},e.Aa=function(t,i){return e.$()*(i-t)+t}},{}],6:[function(t,i,e){function h(){var t=[];t[v]=1;var i=t[g]=d(x[0],x[1]);return t[y]=d(i*M[0],i*M[1]),t}function s(t){for(var i=[0,0,0],e=d(m[0],m[1]),h=0;h<3;h++)i[h]=t[h]*e;return i}function a(t,i){for(var e=~~(t/f),h=t,s=[],a=e;a>=2;a--){var o=(p()+.5)*(h/a);s.push(o),h-=o,i.push(0)}return s.push(h),s}function o(t,i,e,h,s,a){for(var o=h,r=i.length,n=Math.max((a-s)/F+1,0),l=0;l<r-1;l++){var u=(l+.5)*f,d=h-o+i[l]/2,v=Math.max((d-h)/k+1,0),g=Math.min(Math.abs(d-u)/c,1),y=e[l];y=y*(1-g)+(p()-.5)*S,e[l]=y=Math.max(Math.min(y,b),-b);var x=i[l]+y;x=o/(r-l)*v+x*(1-v);var M=t[l]*n+x*(1-n);i[l]=M,o-=M}i[r-1]=o}function r(t){for(var i=h(),e=s(i),a=d(w[0],w[1]),o=[0,0,0],r=[],n=t-1;n>=0;n--){for(var f=n%2?1-p()*a:0+p()*a,c=0;c<3;c++)o[c]=f*i[c]+(1-f)*e[c];for(var l="#",c=0;c<3;c++)l+=("0"+Math.round(255*o[c]).toString(16)).slice(-2);r[n]=l}return r}function n(t,i,e,h){u(e),f=d(1.2,2.4)*h,c=d(1,2.5)*f;var s=[],n=a(t.width,s),l=n.length;u(i);var p=r(l);u(e);for(var v=n.concat(),g=t.getContext("2d"),y=0;y<t.height;y++){for(var b=0,S=0;S<l;S++){g.fillStyle=p[S];var k=v[S];g.fillRect(b,y,k+1,1),b+=k}o(n,v,s,t.width,t.height,y)}}var f,c,l=t("./cheapSeed"),u=l.S,p=l.$,d=l.Aa,v=0,g=1,y=2,b=.12,S=b/8,k=30,F=100,x=[.4,.85],M=[.6,.9],m=[.75,.9],w=[.2,.5];e.R=function(t,i,e,h){n(t,i,e,h)}},{"./cheapSeed":5}]},{},[2])(2)});